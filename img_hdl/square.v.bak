module square(
  input wire clk,
  input wire rst,
  input wire [31:0] data,
  output reg [31:0] balance_factor
);

  always @(posedge clk or posedge rst) begin
    if (rst) begin
      balance_factor <= 0;
    end else begin
      // Tính cân bậc 2 của cây
      balance_factor <= balance_factor_of_tree(data);
    end
  end

  // Hàm tính cân bậc 2 của cây
  function [31:0] balance_factor_of_tree(input wire [31:0] data);
    reg [31:0] height_left, height_right;

    // Tìm chiều cao của cây con trái
    if (data == 0) begin
      height_left <= 0;
    end else begin
      height_left <= balance_factor_of_tree(data[31:0]);
    end

    // Tìm chiều cao của cây con phải
    if (data[31] == 0) begin
      height_right <= 0;
    end else begin
      height_right <= balance_factor_of_tree(data[31:1]);
    end

    // Tính cân bậc 2
    return height_left - height_right;
  endfunction

endmodule
